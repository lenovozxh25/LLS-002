<template>
  <div id="myCourse">
    <div class="courseTitle">
      <div>
        <div class="title1">
          <svg class="bookSvg" viewBox="0 0 1024 1024" width="30" height="30">
            <path
              d="M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z"
              fill="#FF7575"
              p-id="23753"
            ></path>
            <path
              d="M784.96 250.638933H546.4512c-15.170133 0-27.584 12.392533-27.584 27.537067v507.1168c0 9.559467 2.5088 9.832533 6.596267 9.832533 15.633067-9.9776 54.980267-28.1856 124.580266-28.1856 105.943467 0 120.48 25.339733 152.6592 25.339734 21.704533-7.421867 37.4272-28.0192 37.4272-52.117334V305.713067c0.002133-30.2912-24.8256-55.074133-55.170133-55.074134z"
              fill="#FEFFFA"
              p-id="23754"
            ></path>
            <path
              d="M239.466667 250.638933h238.5088c15.170133 0 27.584 12.392533 27.584 27.537067v507.1168c0 9.559467-2.510933 9.832533-6.5984 9.832533-15.633067-9.9776-40.904533-29.723733-118.122667-32.7808-105.860267-4.189867-118.980267 16.925867-159.1168 16.925867-21.7024-7.419733-37.425067-21.514667-37.425067-45.6128V305.713067c0-30.2912 24.8256-55.074133 55.170134-55.074134z"
              fill="#FFDDD9"
              p-id="23755"
            ></path>
            <path
              d="M253.442133 261.344h166.8288c30.2912 0 55.072-20.7488 55.072 9.5424l30.519467 501.019733c0 30.2912-42.8352-19.790933-120.855467-26.389333-84.3776-7.136-131.1808 8.413867-131.1808 8.413867-15.144533 0-27.537067-12.392533-27.537066-27.534934l-0.384-437.514666c0.002133-15.144533 12.392533-27.537067 27.537066-27.537067z"
              fill="#FFC5C4"
              p-id="23756"
            ></path>
            <path
              d="M290.1632 223.101867h160.322133c30.2912 0 55.074133 24.782933 55.074134 55.072v488.379733c0 30.286933-39.8528-29.736533-117.8752-36.334933-84.375467-7.136-97.521067-0.576-97.521067-0.576-15.144533 0-27.537067-12.392533-27.537067-27.534934V250.638933c0-15.146667 12.392533-27.537067 27.537067-27.537066z"
              fill="#FEFFFA"
              p-id="23757"
            ></path>
            <path
              d="M791.0464 295.095467c-4.187733-3.3728-44.878933-8.0448-110.3936-8.0448s-106.208 4.672-110.3936 8.0448c0.16-0.130133 0.618667-0.701867 0.618667-1.602134h-6.8864c0-3.965867 2.730667-7.488 36.305066-10.417066 21.480533-1.8752 50.016-2.907733 80.356267-2.907734 30.338133 0 58.8736 1.032533 80.356267 2.907734 33.570133 2.9312 36.302933 6.4512 36.302933 10.417066h-6.884267c0 0.900267 0.456533 1.474133 0.618667 1.602134zM791.0464 362.8608c-4.187733-3.3728-44.878933-8.0448-110.3936-8.0448s-106.208 4.672-110.3936 8.0448c0.16-0.130133 0.618667-0.701867 0.618667-1.604267h-6.8864c0-3.965867 2.730667-7.485867 36.305066-10.417066 21.480533-1.8752 50.016-2.907733 80.356267-2.907734 30.338133 0 58.8736 1.032533 80.356267 2.907734 33.570133 2.9312 36.302933 6.4512 36.302933 10.417066h-6.884267c0 0.9024 0.456533 1.474133 0.618667 1.604267zM791.0464 430.624c-4.187733-3.3728-44.878933-8.0448-110.3936-8.0448s-106.208 4.672-110.3936 8.0448c0.16-0.130133 0.618667-0.701867 0.618667-1.602133h-6.8864c0-3.965867 2.730667-7.488 36.305066-10.417067 21.480533-1.8752 50.016-2.909867 80.356267-2.909867 30.338133 0 58.8736 1.032533 80.356267 2.909867 33.570133 2.929067 36.302933 6.4512 36.302933 10.417067h-6.884267c0 0.9024 0.456533 1.474133 0.618667 1.602133zM791.0464 498.389333c-4.187733-3.3728-44.878933-8.0448-110.3936-8.0448s-106.208 4.672-110.3936 8.0448c0.16-0.130133 0.618667-0.701867 0.618667-1.602133h-6.8864c0-3.965867 2.730667-7.488 36.305066-10.417067 21.480533-1.8752 50.016-2.907733 80.356267-2.907733 30.338133 0 58.8736 1.032533 80.356267 2.907733 33.570133 2.9312 36.302933 6.4512 36.302933 10.417067h-6.884267c0 0.900267 0.456533 1.474133 0.618667 1.602133zM791.0464 566.154667c-4.187733-3.3728-44.878933-8.0448-110.3936-8.0448s-106.208 4.672-110.3936 8.0448c0.16-0.132267 0.618667-0.701867 0.618667-1.604267h-6.8864c0-3.963733 2.730667-7.485867 36.305066-10.417067 21.480533-1.8752 50.016-2.907733 80.356267-2.907733 30.338133 0 58.8736 1.032533 80.356267 2.907733 33.570133 2.9312 36.302933 6.4512 36.302933 10.417067h-6.884267c0 0.9024 0.456533 1.472 0.618667 1.604267zM791.0464 633.92c-4.187733-3.374933-44.878933-8.0448-110.3936-8.0448s-106.208 4.669867-110.3936 8.0448c0.16-0.132267 0.618667-0.704 0.618667-1.6064h-6.8864c0-3.963733 2.730667-7.485867 36.305066-10.414933 21.480533-1.879467 50.016-2.907733 80.356267-2.907734 30.338133 0 58.8736 1.028267 80.356267 2.907734 33.570133 2.929067 36.302933 6.449067 36.302933 10.414933h-6.884267c0 0.9024 0.456533 1.476267 0.618667 1.6064zM791.0464 701.681067c-4.187733-3.3728-44.878933-8.0448-110.3936-8.0448s-106.208 4.669867-110.3936 8.0448c0.16-0.130133 0.618667-0.699733 0.618667-1.604267h-6.8864c0-3.963733 2.730667-7.485867 36.305066-10.414933 21.480533-1.877333 50.016-2.909867 80.356267-2.909867 30.338133 0 58.8736 1.032533 80.356267 2.909867 33.570133 2.929067 36.302933 6.449067 36.302933 10.414933h-6.884267c0 0.904533 0.456533 1.476267 0.618667 1.604267z"
              fill="#FFDDD9"
              p-id="23758"
            ></path>
          </svg>
          {{this.$route.params.name}}
        </div>
        <div class="title2">{{this.$route.params.name}}</div>
      </div>
    </div>
    <div class="courseTest">
      <div>
        <template>
          <el-tabs
            v-model="activeName"
            @tab-click="handleClick"
            :tab-position="tabPosition"
            style="height: 800px;"
            type="border-card"
          >
            <el-tab-pane
              :label="item.name"
              :name="item.id.toString()"
              v-for="(item,index) in MyMaterialData"
              :key="index"
            >
              <!-- <p>{{item.name}}列表</p> -->
              
                <div class="session" v-if='item.id==1'>
                  <div class="videoPlay">
                     <video-player
                    class="video-player vjs-custom-skin"
                    ref="videoPlayer"
                    :playsinline="true"
                    :options="playerOptions"
                  ></video-player>
                  </div>
                  <div class="videoList">
                    <div>
                      <h3>
                        <svg
                          viewBox="0 0 1024 1024"
                          width="40"
                          height="30"
                          style="position: relative; top: 9px;"
                        >
                          <path
                            d="M624.32 484.48a32 32 0 0 1 0 55.04l-160 96A32 32 0 0 1 416 608V416a32 32 0 0 1 48.32-27.52zM480 472.64v78.72L545.92 512z"
                            p-id="1141"
                          ></path>
                          <path
                            d="M896 768V256H128v512z m0 64H128a64 64 0 0 1-64-64V256a64 64 0 0 1 64-64h768a64 64 0 0 1 64 64v512a64 64 0 0 1-64 64z"
                            p-id="1142"
                          ></path>
                          <path d="M192 224a32 32 0 0 1 64 0v544a32 32 0 0 1-64 0z" p-id="1143"></path>
                          <path
                            d="M224 384a32 32 0 0 1 0 64H96a32 32 0 0 1 0-64z m0 192a32 32 0 0 1 0 64H96a32 32 0 0 1 0-64z m544-352a32 32 0 0 1 64 0v544a32 32 0 0 1-64 0z"
                            p-id="1144"
                          ></path>
                          <path
                            d="M800 448a32 32 0 0 1 0-64h128a32 32 0 0 1 0 64z m0 192a32 32 0 0 1 0-64h128a32 32 0 0 1 0 64z"
                            p-id="1145"
                          ></path>
                        </svg>视频播放列表
                      </h3>
                      <ul class="videoListItem" style="cursor: pointer;">
                        <li @click="tab(index,item.fileWebUrl)"  :class="{active : index===curId}" v-for="(item,index) in MyMaterialDetailsData" :key='index'>
                          <a>{{item.fileName}}</a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <template v-else-if="item.id==2">
                <div class="outer-container">
                  <div class="demo-image__lazy inner-container">
                    <el-image
                      v-for="url in urls"
                      :key="url.id"
                      :src="url.fileWebUrl"
                      scroll-container="auto"
                    ></el-image>
                  </div>
                </div>
              </template>
                <template v-else>
                  <el-table
                    :data="MyMaterialDetailsData"
                    style="width: 100%">
                    <el-table-column
                      prop="index"
                      label="序号"
                      width="130">
                    </el-table-column>
                    <el-table-column
                      prop="fileName"
                      label="文件名称"
                      width="260">
                    </el-table-column>
                    <el-table-column
                      prop="fileAuthor"
                      label="作者"
                      width="180">
                    </el-table-column>
                    <el-table-column
                      label="操作">
                        <template slot-scope="scope">
                          <div>
                            <el-link type="primary" @click="downloadFile(scope.row.id)">下载资源</el-link>
                          </div>
                        </template>
                    </el-table-column>
                  </el-table>
                </template>
              
              <!-- <video :src="item.fileUrl"></video>	 -->
            </el-tab-pane>
          </el-tabs>
        </template>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  name: "myCourse",
  data() {
    return {
      curId: 0, //默认按时第一个视频，下标0
      activeName: "1",     //tab标签默认选中
      MyMaterialDetailsData: [],  //教学视频 精品课件 课堂案例 企业问答 其它资料跳转获取的相应资料
      MyMaterialData: [],     //课程资料列表
      tabPosition: "left",    //tab对应方向
      playerOptions: {
        playbackRates: [0.7, 1.0, 1.5, 2.0], //播放速度
        autoplay: false, //如果true,浏览器准备好时开始回放。
        muted: false, // 默认情况下将会消除任何音频。
        loop: false, // 导致视频一结束就重新开始。
        preload: "auto", // 建议浏览器在<video>加载元素后是否应该开始下载视频数据。auto浏览器选择最佳行为,立即开始加载视频（如果浏览器支持）
        language: "zh-CN",
        aspectRatio: "16:9", // 将播放器置于流畅模式，并在计算播放器的动态大小时使用该值。值应该代表一个比例 - 用冒号分隔的两个数字（例如"16:9"或"4:3"）
        fluid: true, // 当true时，Video.js player将拥有流体大小。换句话说，它将按比例缩放以适应其容器。
        sources: [
          {
            type: "", //这里的种类支持很多种：基本视频格式、直播、流媒体等，具体可以参看git网址项目
            src: "" //url地址
          }
        ],
        poster: "../../static/images/vue.jpg", //你的封面地址
        // width: document.documentElement.clientWidth, //播放器宽度
        notSupportedMessage: "此视频暂无法播放/无此视频资源，请稍后再试", //允许覆盖Video.js无法播放媒体源时显示的默认信息。
        controlBar: {
          timeDivider: true,
          durationDisplay: true,
          remainingTimeDisplay: false,
          fullscreenToggle: true //全屏按钮
        }
      },
      urls:[]
    };
  },
  methods: {
     //视频切换，仿照选项卡事件
     tab (index,fileWebUrl) {
        this.curId = index;
        this.playerOptions.sources[0].src = fileWebUrl;
      },
    handleClick(tab, event) {
      console.log(tab.name);
      
      // console.log(event);
      this.getMyMaterialDetails(
        this.$route.params.courseId,
        tab.name-0,
        tab.label
      );
    },

    //获取课程资料列表
    getMyMaterial() {
      var app = this;
      this.$http
        .get("/product/materialType/listForAble")
        // courseId typeId
        .then(function(res) {
          app.MyMaterialData = res.data;
          console.log(res.data);
        });
    },
    //点击教学视频 精品课件 课堂案例 企业问答 其它资料等跳转到相对应的资料
    getMyMaterialDetails(courseId, typeId, name) {
      console.log(courseId)
      console.log(typeId)
      var app = this;
      this.$http
        .get(
          `/product/customMaterial/getListByCourseIdAndTypeId/${courseId}/${
            typeId ? typeId : 1
          }`
        )
        .then(function(res) {
          app.MyMaterialDetailsData = res.data;
          app.activeName = typeId?typeId.toString():"1";
          if (typeId == 1) {
            app.playerOptions.sources[0].src = res.data[0].fileWebUrl;
          }
          if (typeId == 2) {
            app.urls = res.data;
          }
        });
    },
    //下载资源
    downloadFile(id) {
      window.location.href = `http://10.119.129.135:9090/zuul/v2.0/lls/product/customMaterial/downLoadFile/${id}`;
    },
  },
  created() {
    // console.log(this.$route.params.itemName);
    this.getMyMaterialDetails(
      this.$route.params.courseId,
      this.$route.params.typeId,
      this.$route.params.itemName
    );
    this.getMyMaterial();
  }

};
</script>

<style>
.courseTitle {
  width: 100%;
  height: 144px;
  background: linear-gradient(60deg, #91b0ed, #e67df4);
  position: relative;
}

.courseTitle > div {
  width: 1100px;
  height: 144px;
  margin: auto;
  text-align: center;
  color: #fff;
}

.courseTitle div .title1 {
  min-width: 400px;
  font-size: 30px;
  padding-top: 40px;
  line-height: 75px;
}

.courseTitle .title2 {
  text-align: center;
  font-size: 60px;
  position: absolute;
  left: 50%;
  margin-left: -180px;
  top: 50%;
  margin-top: -46px;
  opacity: 0.15;
}

.bookSvg {
  position: absolute;
  left: 40%;
  top: 43%;
}

.courseTest {
  width: 1100px;
  margin: auto;
}
.session {
  width: 100%;
  z-index: 1;
  position: relative;
  top: -1px;
  min-height: 500px;
  padding-top: 20px;
  overflow: hidden;
}
.session .videoPlay {
  width: 600px;
  height: 360px;
  float: left;
  margin-top: 30px;
}
.session .videoList {
  margin-left: 30px;
  float: left;
  width: 300px;
}
.session .videoListItem {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  color: rgba(0, 0, 0, 0.65);
  font-size: 14px;
  font-variant: tabular-nums;
  line-height: 1.5;
  list-style: none;
  font-feature-settings: "tnum";
  position: relative;
}
.session .videoListItem li {
  padding: 16px;
  background: #fff;
  border-bottom: 1px solid #e9e9e9;
}
.videoListItem li.active a{
    color: red;
  }
  .video-js .vjs-icon-placeholder {
  width: 100%;
  height: 100%;
  display: block;
}
.outer-container {
  width: 100%;
  height: 785px;
  position: relative;
  overflow: hidden;
 
}
.inner-container {
  position: absolute;
  left: 0;
  top: 0;
  right: -17px;
  bottom: 0;
  overflow-x: hidden;
  overflow-y: scroll;
}
</style>